<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Barcode Scanner</title>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap">
	<script src="jquery.js"></script>
	<script src="barcode.js"></script>
	<link rel="stylesheet" href="">
	<link rel="stylesheet" href="style.css">
	
</head>

<body>

	<div class="container">
		<div class="header">
			<button class="back-btn" onclick="goBack()">‚¨ÖÔ∏è</button>
			‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î
		</div>

		<h1>üì∑ Barcode Scanner</h1>

		<div id="barcode">
			<video id="barcodevideo" autoplay playsinline></video>
			<div id="scan-line"></div>
		</div>

		<div id="result">üì° ‡∏£‡∏≠‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î...</div>

		<!-- canvas ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• -->
		<canvas id="barcodecanvas"></canvas>
		<canvas id="barcodecanvasg"></canvas>
	</div>
	<div id="productModal" style="display:none;" class="modal">
		<div class="modal-content">
			<span class="close-btn" onclick="closeModal()">‚úñ</span>
			<h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
			<label>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
			<input type="text" id="productCode" readonly>
			
			<label>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
			<input type="text" id="productName">
			
			<label>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó):</label>
			<input type="number" id="productPrice" min="0" step="0.01">
			
			<label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á:</label>
			<input type="number" id="productStock" min="0">
			
			<label>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
			<input type="file" id="productImageInput" accept="image/*" onchange="previewImage(event)">
			<img id="productImagePreview" src="" style="display:none; width: 100px; height: 100px; margin-top: 10px; object-fit: cover; border: 1px solid #ccc;">
			
			<button onclick="saveProduct()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
		</div>
	</div>
</body>
<script>
	var sound = new Audio("barcode.wav");
	var isScanning = true;

	$(document).ready(function () {
		initBarcodeScanner();

		function initBarcodeScanner() {
			barcode.config.start = 0.1;
			barcode.config.end = 0.9;
			barcode.config.video = '#barcodevideo';
			barcode.config.canvas = '#barcodecanvas';
			barcode.config.canvasg = '#barcodecanvasg';

			barcode.setHandler(function (barcode) {
				if (!isScanning) return;

				$('#result').html('üì¶ ‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î: ' + barcode);
				playSound();
				isScanning = false;
				showProductDetail(barcode);
				// ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 1.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
				setTimeout(function () {
					isScanning = true;
				}, 1500);
			});

			barcode.init();
		}

		function playSound() {
			sound.play().catch(function (e) {
				console.warn('Autoplay prevented:', e);
			});
		}
	});

	function goBack() {
		window.location.href = '../index.html';  // ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ history.back(); ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
	}

	function showProductDetail(barcode) {
		document.getElementById('productCode').value = barcode;
		$('#productModal').fadeIn();
	}

	function closeModal() {
		$('#productModal').fadeOut();
	}

	function previewImage(event) {
		const input = event.target;
		if (input.files && input.files[0]) {
			const reader = new FileReader();
			reader.onload = function (e) {
				document.getElementById('productImagePreview').src = e.target.result;
				document.getElementById('productImagePreview').style.display = 'block';
			};
			reader.readAsDataURL(input.files[0]);
		}
	}
</script>
</html>
